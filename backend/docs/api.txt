Marian Schubert


Table of Contents
─────────────────

1 API
.. 1.1 Wallet info
.. 1.2 Invoice info
.. 1.3 Process transaction (invoice)
.. 1.4 List transactions
.. 1.5 Send Bitcoin to email address
..... 1.5.1 Create transaction (payee)
..... 1.5.2 Claim transaction (payer)
..... 1.5.3 Payee sees that transaction has been claimed





1 API
═════

1.1 Wallet info
───────────────

  ┌────
  │ _ = GET('/api/wallet')
  └────

  ┌────
  │ {
  │   "data": {
  │     "balance": {
  │       "msatoshi": 1000000000
  │     },
  │     "id": "c0801ace-7f38-46cd-82ec-73f1fa3a4d20"
  │   }
  │ }
  └────


1.2 Invoice info
────────────────

  ┌────
  │ _ = GET('/api/wallet/invoice/lntb1500n1pd0c66dpp5p8rpzxck9u7umfl9u7dqratj8rlfthe29xl6ejhwt2exuaxfpftqdqvg9jxgg8zn2sscqzysyv8kgctq7haghaus4wqd262mxr9342mvp23gdsv6vmgkce9zgshjd0av06dq3xpe8cy6fucnj454smkqxuetyvu3h5jggx2w8ethlvcp6g3ldq')
  └────

  ┌────
  │ {
  │   "data": {
  │     "description": "Foobar #ldq",
  │     "dst_alias": "Barbaz #039",
  │     "msatoshi": 150000
  │   }
  │ }
  └────


1.3 Process transaction (invoice)
─────────────────────────────────

  ┌────
  │ _ = POST('/api/wallet/transactions', {"invoice": "lntb1500n1pd0c66dpp5p8rpzxck9u7umfl9u7dqratj8rlfthe29xl6ejhwt2exuaxfpftqdqvg9jxgg8zn2sscqzysyv8kgctq7haghaus4wqd262mxr9342mvp23gdsv6vmgkce9zgshjd0av06dq3xpe8cy6fucnj454smkqxuetyvu3h5jggx2w8ethlvcp6g3ldq"})
  └────

  ┌────
  │ {
  │   "data": {
  │     "description": "Foobar #ldq",
  │     "id": "064638ab-166f-4f35-b1a6-3f0a0101a0fe",
  │     "inserted_at": "2018-08-25T16:06:51.717780",
  │     "invoice": "lntb1500n1pd0c66dpp5p8rpzxck9u7umfl9u7dqratj8rlfthe29xl6ejhwt2exuaxfpftqdqvg9jxgg8zn2sscqzysyv8kgctq7haghaus4wqd262mxr9342mvp23gdsv6vmgkce9zgshjd0av06dq3xpe8cy6fucnj454smkqxuetyvu3h5jggx2w8ethlvcp6g3ldq",
  │     "msatoshi": -150000,
  │     "processed_at": "2018-08-25T16:06:51.772826",
  │     "state": "approved"
  │   }
  │ }
  └────


1.4 List transactions
─────────────────────

  ┌────
  │ _ = GET('/api/wallet/transactions')
  └────

  ┌────
  │ {
  │   "data": [
  │     {
  │       "description": "Foobar #ldq",
  │       "id": "064638ab-166f-4f35-b1a6-3f0a0101a0fe",
  │       "inserted_at": "2018-08-25T16:06:51.717780",
  │       "invoice": "lntb1500n1pd0c66dpp5p8rpzxck9u7umfl9u7dqratj8rlfthe29xl6ejhwt2exuaxfpftqdqvg9jxgg8zn2sscqzysyv8kgctq7haghaus4wqd262mxr9342mvp23gdsv6vmgkce9zgshjd0av06dq3xpe8cy6fucnj454smkqxuetyvu3h5jggx2w8ethlvcp6g3ldq",
  │       "msatoshi": -150000,
  │       "processed_at": "2018-08-25T16:06:51.772826",
  │       "state": "approved"
  │     },
  │     {
  │       "description": "Funding transaction",
  │       "id": "5a7b3449-e3e0-45c3-bb03-2d1420e293b3",
  │       "inserted_at": "2018-08-25T16:06:51.485356",
  │       "msatoshi": 1000000000,
  │       "processed_at": null,
  │       "state": "approved"
  │     }
  │   ]
  │ }
  └────


1.5 Send Bitcoin to email address
─────────────────────────────────

1.5.1 Create transaction (payee)
╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌

  ┌────
  │ email_src_trn = POST('/api/wallet/transactions', {
  │     "to_email": "a@b.cz",
  │     "msatoshi": 1000,
  │     "description": "Free BTC",
  │     "expires_after": 900
  │ })['data']
  └────

  ┌────
  │ {
  │   "data": {
  │     "claim_expires_at": "2018-08-25T16:18:14.170513",
  │     "description": "Free BTC",
  │     "id": "201992a6-3636-4133-a661-b2c24f5735aa",
  │     "inserted_at": "2018-08-25T16:03:14.170590",
  │     "msatoshi": -1000,
  │     "processed_at": null,
  │     "state": "initial"
  │   }
  │ }
  └────


1.5.2 Claim transaction (payer)
╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌

  ┌────
  │ _ = POST('/api/wallet/transactions', {"claim_token": "373e4ceb-e305-49ee-bc40-ddf6cb9e73c1"})
  └────

  ┌────
  │ {
  │   "data": {
  │     "description": "Free BTC",
  │     "id": "32d8284d-90cc-4737-ae56-2eb1c6e2a732",
  │     "inserted_at": "2018-08-25T16:04:19.984684",
  │     "msatoshi": 1000,
  │     "processed_at": "2018-08-25T16:04:19.984597",
  │     "state": "approved"
  │   }
  │ }
  └────


1.5.3 Payee sees that transaction has been claimed
╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌

  status
        approved
  processed_at
        timestamp of claim event

  ┌────
  │ _ = GET('/api/wallet/transactions/' + email_src_trn['id'])
  └────

  ┌────
  │ {
  │   "data": {
  │     "claim_expires_at": "2018-08-25T16:18:14.170513",
  │     "description": "Free BTC",
  │     "id": "201992a6-3636-4133-a661-b2c24f5735aa",
  │     "inserted_at": "2018-08-25T16:03:14.170590",
  │     "msatoshi": -1000,
  │     "processed_at": "2018-08-25T16:04:19.986538",
  │     "state": "approved"
  │   }
  │ }
  └────
